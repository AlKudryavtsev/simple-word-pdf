{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import fs from 'fs'\nimport * as libre from 'libreoffice-convert';\nimport { promisify } from 'util';\nimport path from 'path';\n\nconst convert = promisify(libre.convert);\n\nexport async function convertWordToPdf(src: string) {\n  if (! fs.existsSync(src)) return null;\n  const ext = path.extname(src);\n  if (ext === \".pdf\") return src;\n\n  const out = src + \".pdf\";\n  const pdfBuffer = await convert(fs.readFileSync(out), 'pdf', undefined);\n  fs.writeFileSync(out, pdfBuffer);\n\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,QAAQ;AACf,YAAY,WAAW;AACvB,SAAS,iBAAiB;AAC1B,OAAO,UAAU;AAEjB,IAAMA,WAAU,UAAgB,aAAO;AAEvC,SAAsB,iBAAiB,KAAa;AAAA;AAClD,QAAI,CAAE,GAAG,WAAW,GAAG,EAAG,QAAO;AACjC,UAAM,MAAM,KAAK,QAAQ,GAAG;AAC5B,QAAI,QAAQ,OAAQ,QAAO;AAE3B,UAAM,MAAM,MAAM;AAClB,UAAM,YAAY,MAAMA,SAAQ,GAAG,aAAa,GAAG,GAAG,OAAO,MAAS;AACtE,OAAG,cAAc,KAAK,SAAS;AAAA,EAEjC;AAAA;","names":["convert"]}